<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<HTML>
<HEAD>
	<META HTTP-EQUIV="CONTENT-TYPE" CONTENT="text/html; charset=utf-8">
	<TITLE></TITLE>
	<META NAME="GENERATOR" CONTENT="OpenOffice.org 1.1.0  (Linux)">
	<META NAME="CREATED" CONTENT="20041109;10003000">
	<META NAME="CHANGED" CONTENT="20050126;11183400">
	<STYLE>
	<!--
		@page { size: 8.5in 11in; margin-left: 1.25in; margin-right: 1.25in; margin-top: 1in; margin-bottom: 1in }
		P { margin-bottom: 0.08in }
		H2 { margin-bottom: 0.04in; color: #000000; text-align: center; widows: 2; orphans: 2 }
		H2.western { font-family: "Times New Roman", serif; font-size: 12pt; so-language: en-GB }
		H2.cjk { font-family: "Times New Roman", serif; font-size: 12pt }
		H2.ctl { font-family: "Arial", sans-serif; font-size: 14pt; so-language: ar-SA; font-style: italic }
		H3 { margin-top: 0.08in; margin-bottom: 0.04in; color: #000000; widows: 2; orphans: 2 }
		H3.western { font-family: "Times New Roman", serif; font-size: 12pt; so-language: en-GB; font-style: italic; font-weight: medium }
		H3.cjk { font-family: "Times New Roman", serif; font-size: 12pt; font-style: italic; font-weight: medium }
		H3.ctl { font-family: "Arial", sans-serif; font-size: 13pt; so-language: ar-SA }
		P.sdendnote-western { margin-left: 0.25in; text-indent: -0.25in; margin-bottom: 0in; color: #000000; font-family: "Times New Roman", serif; font-size: 10pt; so-language: en-GB; text-align: justify; widows: 2; orphans: 2 }
		P.sdendnote-cjk { margin-left: 0.25in; text-indent: -0.25in; margin-bottom: 0in; color: #000000; font-family: "Times New Roman", serif; font-size: 10pt; text-align: justify; widows: 2; orphans: 2 }
		P.sdendnote-ctl { margin-left: 0.25in; text-indent: -0.25in; margin-bottom: 0in; color: #000000; font-family: "Times New Roman", serif; font-size: 10pt; so-language: ar-SA; text-align: justify; widows: 2; orphans: 2 }
		A.sdendnotesym-western { font-family: "Times New Roman", serif; font-size: 10pt }
		A.sdendnotesym-cjk { font-size: 10pt }
	-->
	</STYLE>
</HEAD>
<BODY LANG="en-US" DIR="LTR">
<H2 LANG="en-GB" CLASS="western">FERMILAB UNIX File System SRM</H2>
<P LANG="en-GB" ALIGN=JUSTIFY STYLE="margin-bottom: 0in; widows: 2; orphans: 2">
<FONT COLOR="#000000"><FONT FACE="Times New Roman, serif"><FONT SIZE=2>Fermilab
provides a reference implementation of the SRM-Storage  interface to
a Unix File System. You can read more about SRM interface at
[1,2,3,4].  Fermilab's srm implementation conforms to the SRM version
1.1 specification. Fermilab srm implementation is developed as a part
of  DESY – Fermilab dCache project [5].  Its source is available
for download from [4]. It provides the following features: fully
blown implementation of srm v1.1 specification, support for srm
“get”, “put” and “copy” functions,  gsiftp as a transfer
protocol for “get “ and “put” operations,  built-in gsiftp
client for SRM to SRM or MSS transfers. This reference implementation
provides highly configurable transfer scheduling mechanism, which
utilizes queues and limits the number  of simultaneous transfers
performed by either client or server itself. It retries each
operation upon failure and uses database to store its state to
provide a high level of robustness and reliability.</FONT></FONT></FONT></P>
<H3 LANG="en-GB" CLASS="western"><FONT FACE="Times New Roman">CVS
access to File System SRM and SRM client.</FONT></H3>
<P LANG="en-GB" ALIGN=JUSTIFY STYLE="margin-bottom: 0in; widows: 2; orphans: 2">
<FONT COLOR="#000000"><FONT FACE="Times New Roman, serif"><FONT SIZE=2><FONT FACE="Times New Roman">The
latest version of this product can be downloaded from the publically
accessible cvs repository. </FONT></FONT></FONT></FONT>
</P>
<P LANG="en-GB" ALIGN=JUSTIFY STYLE="margin-bottom: 0in; widows: 2; orphans: 2">
<FONT COLOR="#000000"><FONT FACE="Times New Roman, serif"><FONT SIZE=2>To
access srm public DCACHE CVS repository, execute the following cvs
commands:</FONT></FONT></FONT></P>
<PRE STYLE="margin-left: 0.49in">$ cvs -d :pserver:cvs@cvs.dcache.org:/cvs login
Logging in to :pserver:cvs@cvs.dcache.org:2401/cvs
CVS password: (password is 'cvs')
$ cvs -d :pserver:cvs@cvs.dcache.org:/cvs co srm srmclient
</PRE><P LANG="en-GB" ALIGN=JUSTIFY STYLE="margin-bottom: 0in; widows: 2; orphans: 2">
<FONT COLOR="#000000"><FONT FACE="Times New Roman, serif"><FONT SIZE=2><FONT FACE="Times New Roman">The
prerequisite to the srm installation if the presence  of the host
certificates and the functional gsiftp server installation from
globus toolkit on the node.  SRM product uses of the postgress
database, which should be installed and running on one of the network
reachable server, with username and password available. SRM server is
a java program, which will need the java compiler for building and
java virtual machine for execution. Please refer to [6], [7] and [8]
for installation and configuration instructions of gridftp server,
postgres database server and java development kit (jdk).</FONT></FONT></FONT></FONT></P>
<H3 LANG="en-GB" CLASS="western"><FONT FACE="Times New Roman">Building.</FONT></H3>
<P LANG="en-GB" ALIGN=JUSTIFY STYLE="margin-bottom: 0in; widows: 2; orphans: 2">
<BR>
</P>
<P LANG="en-GB" ALIGN=JUSTIFY STYLE="margin-bottom: 0in; widows: 2; orphans: 2">
<FONT COLOR="#000000"><FONT FACE="Times New Roman"><FONT SIZE=2>To
build SRM , make the root directory of srm product your current than
execute the following  command:</FONT></FONT></FONT></P>
<PRE STYLE="margin-left: 0.49in"><FONT FACE="Times New Roman"><FONT FACE="Luxi Mono">$ ./makeUnixfsSRM.sh</FONT></FONT>
</PRE><P LANG="en-GB" ALIGN=JUSTIFY STYLE="margin-bottom: 0in; widows: 2; orphans: 2">
<BR>
</P>
<P LANG="en-GB" ALIGN=JUSTIFY STYLE="margin-bottom: 0in; widows: 2; orphans: 2">
<FONT COLOR="#000000"><FONT FACE="Times New Roman"><FONT SIZE=2>Note:
The script <FONT FACE="Luxi Mono">makeUnixfsSRM.sh</FONT> relies on
the presence of Sun Microsystem's java 1.4 development kit. The
system path should include the kit's bin directory containing javac
compiler.</FONT></FONT></FONT></P>
<H3 LANG="en-GB" CLASS="western"><FONT FACE="Times New Roman">Configuration.</FONT></H3>
<P LANG="en-GB" ALIGN=JUSTIFY STYLE="margin-bottom: 0in; widows: 2; orphans: 2">
<BR>
</P>
<P LANG="en-GB" ALIGN=JUSTIFY STYLE="margin-bottom: 0in; widows: 2; orphans: 2">
<FONT COLOR="#000000"><FONT FACE="Times New Roman"><FONT SIZE=2>Once
the srm is built, you would need to edit .srmconfig/config.xml, and
put in the correct values for sql database user, password, url and
jdbc driver (Postress jdbc driver is included in pgjdbc2.jar ), and
the locations of the host x509 private key and certificate.</FONT></FONT></FONT></P>
<P LANG="en-GB" ALIGN=JUSTIFY STYLE="margin-bottom: 0in; widows: 2; orphans: 2">
<BR>
</P>
<P LANG="en-GB" ALIGN=JUSTIFY STYLE="margin-bottom: 0in; widows: 2; orphans: 2">
<FONT COLOR="#000000"><FONT FACE="Times New Roman"><FONT SIZE=2>You
will also need to edit the script bin/run-unix-fs and put in the
correct values for gridftp server host and port (variables
GRIDFTP_HOST and GRIDFTP_PORT), name of the SRM server (variable
NAME), which needs to be unique for each SRM server using the same
database,  in case of multiple SRMs, and location of the log file
(variable LOG).</FONT></FONT></FONT></P>
<P LANG="en-GB" ALIGN=JUSTIFY STYLE="margin-bottom: 0in; widows: 2; orphans: 2">
<BR>
</P>
<P LANG="en-GB" ALIGN=JUSTIFY STYLE="margin-bottom: 0in; widows: 2; orphans: 2">
<FONT COLOR="#000000"><FONT FACE="Times New Roman"><FONT SIZE=2>In
order to add users to the system, you will have to modify two files:</FONT></FONT></FONT></P>
<P LANG="en-GB" ALIGN=JUSTIFY STYLE="margin-bottom: 0in; widows: 2; orphans: 2">
<FONT COLOR="#000000"><FONT FACE="Times New Roman"><FONT SIZE=2>1.
/etc/grid-security/grid-mapfile to add the mapping from the user
certificate   to the local account</FONT></FONT></FONT></P>
<P LANG="en-GB" ALIGN=JUSTIFY STYLE="margin-bottom: 0in; widows: 2; orphans: 2">
<FONT COLOR="#000000"><FONT FACE="Times New Roman"><FONT SIZE=2>2.
.srmconfig/dcache.kpwd</FONT></FONT></FONT></P>
<P LANG="en-GB" ALIGN=JUSTIFY STYLE="margin-bottom: 0in; widows: 2; orphans: 2">
<FONT COLOR="#000000">  <FONT FACE="Times New Roman"><FONT SIZE=2>to
add the mapping and the login entries for the user. There is a
description of the structure of this file in the prefix of
dcache.kpwd file itself.</FONT></FONT></FONT></P>
<P LANG="en-GB" ALIGN=JUSTIFY STYLE="margin-bottom: 0in; widows: 2; orphans: 2">
<BR>
</P>
<H3 LANG="en-GB" CLASS="western"><FONT FACE="Times New Roman">Running
the server.</FONT></H3>
<P LANG="en-GB" ALIGN=JUSTIFY STYLE="margin-bottom: 0in; widows: 2; orphans: 2">
<FONT COLOR="#000000"><FONT FACE="Times New Roman"><FONT SIZE=2>Once
it is done, you can start the server by running the following
commands as a root from the root directory of the srm product:</FONT></FONT></FONT></P>
<OL>
	<P LANG="en-GB" ALIGN=JUSTIFY STYLE="margin-bottom: 0in; widows: 2; orphans: 2">
	<FONT COLOR="#000000"><FONT FACE="Luxi Mono"><FONT SIZE=2>$
	bin/run-unix-fs</FONT></FONT></FONT></P>
	<P LANG="en-GB" ALIGN=JUSTIFY STYLE="margin-bottom: 0in; widows: 2; orphans: 2">
	</P>
</OL>
<P LANG="en-GB" ALIGN=JUSTIFY STYLE="margin-bottom: 0in; widows: 2; orphans: 2">
<FONT COLOR="#000000"><FONT FACE="Times New Roman"><FONT SIZE=2>Once
this is done, you will see an srm admin shell prompt on the screen,
type help to see the list of available commands. This will allow you
to monitor the state of the system and to cancel the requests.</FONT></FONT></FONT></P>
<P LANG="en-GB" ALIGN=JUSTIFY STYLE="margin-bottom: 0in; widows: 2; orphans: 2">
<FONT COLOR="#000000"><FONT FACE="Times New Roman"><FONT SIZE=2>Note:
SRM will create all the database tables automatically.</FONT></FONT></FONT></P>
<H3 LANG="en-GB" CLASS="western">   <SPAN LANG="en-GB"><FONT FACE="Times New Roman">Building
the srm client.</FONT></SPAN></H3>
<P LANG="en-GB" ALIGN=JUSTIFY STYLE="margin-bottom: 0in; widows: 2; orphans: 2">
<FONT COLOR="#000000"><FONT FACE="Times New Roman"><FONT SIZE=2>Once
the system is running, you can use srmcp client to access the system.
</FONT></FONT></FONT>
</P>
<P LANG="en-GB" ALIGN=JUSTIFY STYLE="margin-bottom: 0in; widows: 2; orphans: 2">
<FONT COLOR="#000000"><FONT FACE="Times New Roman"><FONT SIZE=2>To
build the client do the following:</FONT></FONT></FONT></P>
<P LANG="en-GB" ALIGN=JUSTIFY STYLE="margin-bottom: 0in; widows: 2; orphans: 2">
<FONT COLOR="#000000"><FONT FACE="Times New Roman"><FONT SIZE=2>Assign
the path to the srm server installation directory to an exported
enviroment variable SRM_SERVER:</FONT></FONT></FONT></P>
<P LANG="en-GB" ALIGN=JUSTIFY STYLE="margin-bottom: 0in; widows: 2; orphans: 2">
<BR>
</P>
<P LANG="en-GB" ALIGN=JUSTIFY STYLE="margin-left: 0.49in; margin-bottom: 0in; widows: 2; orphans: 2">
<FONT COLOR="#000000"><FONT FACE="Luxi Mono"><FONT SIZE=2>$ export
SRM_SERVER= &lt;path to srm&gt;</FONT></FONT></FONT></P>
<P LANG="en-GB" ALIGN=JUSTIFY STYLE="margin-bottom: 0in; widows: 2; orphans: 2">
<BR>
</P>
<P LANG="en-GB" ALIGN=JUSTIFY STYLE="margin-bottom: 0in; widows: 2; orphans: 2">
<FONT COLOR="#000000"><FONT FACE="Times New Roman"><FONT SIZE=2>execute
the following  commands:</FONT></FONT></FONT></P>
<P LANG="en-GB" ALIGN=JUSTIFY STYLE="margin-bottom: 0in; widows: 2; orphans: 2">
<BR>
</P>
<P LANG="en-GB" ALIGN=JUSTIFY STYLE="margin-left: 0.49in; margin-bottom: 0in; widows: 2; orphans: 2">
<FONT COLOR="#000000"><FONT FACE="Luxi Mono"><FONT SIZE=2>$ cd
srmclient</FONT></FONT></FONT></P>
<P LANG="en-GB" ALIGN=JUSTIFY STYLE="margin-left: 0.49in; margin-bottom: 0in; widows: 2; orphans: 2">
<FONT COLOR="#000000"><FONT FACE="Luxi Mono"><FONT SIZE=2>$ cp -r
$SRM_SERVER/lib/globus lib/globus</FONT></FONT></FONT></P>
<P LANG="en-GB" ALIGN=JUSTIFY STYLE="margin-left: 0.49in; margin-bottom: 0in; widows: 2; orphans: 2">
<FONT COLOR="#000000"><FONT FACE="Luxi Mono"><FONT SIZE=2>$ cp -r
$SRM_SERVER/lib/axis lib/axis</FONT></FONT></FONT></P>
<P LANG="en-GB" ALIGN=JUSTIFY STYLE="margin-left: 0.49in; margin-bottom: 0in; widows: 2; orphans: 2">
<FONT COLOR="#000000"><FONT FACE="Luxi Mono"><FONT SIZE=2>$ cp -r
$SRM_SERVER/lib/glue lib/glue</FONT></FONT></FONT></P>
<P LANG="en-GB" ALIGN=JUSTIFY STYLE="margin-left: 0.49in; margin-bottom: 0in; widows: 2; orphans: 2">
<FONT COLOR="#000000"><FONT FACE="Luxi Mono"><FONT SIZE=2>$ cp
$SRM_SERVER/lib/*.jar  lib/</FONT></FONT></FONT></P>
<P LANG="en-GB" ALIGN=JUSTIFY STYLE="margin-left: 0.49in; margin-bottom: 0in; widows: 2; orphans: 2">
<FONT COLOR="#000000"><FONT FACE="Luxi Mono"><FONT SIZE=2>$ make</FONT></FONT></FONT></P>
<P LANG="en-GB" ALIGN=JUSTIFY STYLE="margin-left: 0.49in; margin-bottom: 0in; widows: 2; orphans: 2">
<BR>
</P>
<P LANG="en-GB" ALIGN=JUSTIFY STYLE="margin-bottom: 0in; widows: 2; orphans: 2">
<FONT COLOR="#000000"><FONT FACE="Times New Roman"><FONT SIZE=2>Read
README text file to learn about srmcp usage</FONT></FONT></FONT></P>
<P LANG="en-GB" ALIGN=JUSTIFY STYLE="margin-bottom: 0in; widows: 2; orphans: 2">
<BR>
</P>
<H2 LANG="en-GB" CLASS="western">References 
</H2>
<P LANG="en-GB" CLASS="sdendnote-western" STYLE="margin-left: 0in; text-indent: 0in">
<FONT FACE="Times New Roman, serif"><FONT SIZE=2><FONT FACE="Times New Roman">[1]
</FONT><FONT FACE="Times New Roman, serif"><FONT SIZE=2><FONT FACE="Times New Roman"><FONT COLOR="#000000"><SPAN LANG="en-GB">Arie</SPAN>
<SPAN LANG="en-GB">Shoshany</SPAN> at al, </FONT></FONT></FONT></FONT></FONT></FONT>SRM
Joint Design v.1.0, http://sdm.lbl.gov/srm-wg/doc/srm.v1.0.pdf</P>
<P LANG="en-GB" CLASS="sdendnote-western" STYLE="margin-left: 0in; text-indent: 0in">
[2] <FONT FACE="Times New Roman, serif"><FONT SIZE=2><FONT FACE="Times New Roman"><FONT COLOR="#000000">Arie
Shoshany at al, </FONT></FONT></FONT></FONT>SRM Interface 
Specification v.2.1, 
http://sdm.lbl.gov/srm-wg/doc/SRM.spec.v2.1.final.pdf</P>
<P LANG="en-GB" CLASS="sdendnote-western" STYLE="margin-left: 0in; text-indent: 0in">
<FONT FACE="Times New Roman, serif"><FONT SIZE=2><FONT FACE="Times New Roman">[3]</FONT></FONT></FONT><FONT FACE="Times New Roman">	The
Storage Resource Manager Collaboration Pages,
<FONT COLOR="#000000">http://sdm.lbl.gov/srm-wg/</FONT></FONT></P>
<P LANG="en-GB" CLASS="sdendnote-western" STYLE="margin-left: 0in; text-indent: 0in">
<FONT FACE="Times New Roman">[4] 	Fermilab SRM Project ,<FONT COLOR="#000000">
http://www-isd.fnal.gov/srm</FONT></FONT></P>
<P LANG="en-GB" CLASS="sdendnote-western" STYLE="margin-left: 0in; text-indent: 0in">
<FONT COLOR="#000000"><FONT FACE="Times New Roman">[5] <SPAN LANG="en-GB">DCache</SPAN>,
Disk Cache Mass Storage System, http://www.dcache.org/</FONT></FONT></P>
<P LANG="en-GB" CLASS="sdendnote-western" STYLE="margin-left: 0in; text-indent: 0in">
<FONT COLOR="#000000"><FONT FACE="Times New Roman">[6] 
http://www.globus.org</FONT></FONT></P>
<P LANG="en-GB" CLASS="sdendnote-western" STYLE="margin-left: 0in; text-indent: 0in">
<FONT COLOR="#000000"><FONT FACE="Times New Roman">[7]
http://www.postgresql.org/</FONT></FONT></P>
<P LANG="en-GB" CLASS="sdendnote-western" STYLE="margin-left: 0in; text-indent: 0in">
<FONT COLOR="#000000"><FONT FACE="Times New Roman">[8]
http://java.sun.com</FONT></FONT></P>
</BODY>
</HTML>