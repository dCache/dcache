#  -----------------------------------------------------------------------
#     Default values for xrootd
#  -----------------------------------------------------------------------
#
#   This Java properties file contains default values for xrootd
#   configuration parameters. All values can be redefined in
#   etc/dcache.conf. Do not modify any values here as your changes
#   will be lost when you next upgrade.

#  ---- Name of Xrootd door
#
xrootd.cell.name=Xrootd-${host.name}
xrootd/cell.name=${xrootd.cell.name}

#  ---- TCP address and port to bind to
#
#   Specifies the TCP port and address on which the Xrootd door accepts connections.
#
(deprecated)xrootdPort=1094
(deprecated)xrootd/port=${xrootdPort}
xrootd.net.port=${port}
xrootd.net.listen=${dcache.net.listen}

#  ---- TCP backlog used by xrootd
#
#   1024 is typically the largest value allowed by the OS.
#
(deprecated)xrootdBacklog=1024
xrootd.net.backlog=${xrootdBacklog}

#  ---- Worker thread limit
#
#   Maximum number of work threads used by the door. Since the worker
#   threads block on name space and pool manager operations, a
#   relatively large value is needed.
#
(deprecated)xrootdThreads=1000
xrootd.threads=${xrootdThreads}

#  ---- Queue memory limit
#
#   Memory limit in bytes for xrootd frames queued for processing by a
#   worker thread.
#
(deprecated)xrootdMaxTotalMemorySize=16777216
xrootd.max-total-memory-size=${xrootdMaxTotalMemorySize}

#  ---- Per connection queue memory limit
#
#   Per connection memory limit in bytes for xrootd frames queued for
#   processing by a worker thread.
#
(deprecated)xrootdMaxChannelMemorySize=16777216
xrootd.max-channel-memory-size=${xrootdMaxChannelMemorySize}

#  ---- Parameters related to talking to other services
#
(deprecated)xrootdPoolManagerTimeout=5400000
(deprecated)xrootdPoolTimeout=15000
xrootd.service.poolmanager=${dcache.service.poolmanager}
xrootd.service.poolmanager.timeout=${xrootdPoolManagerTimeout}
xrootd.service.poolmanager.timeout.unit=MILLISECONDS
xrootd.service.pnfsmanager=${dcache.service.pnfsmanager}
xrootd.service.gplazma=${dcache.service.gplazma}
xrootd.service.gplazma.timeout=30
xrootd.service.gplazma.timeout.unit=SECONDS
xrootd.service.billing=${dcache.service.billing}
xrootd.service.loginbroker=${dcache.service.loginbroker}
xrootd.service.loginbroker.update-period=${dcache.service.loginbroker.update-period}
xrootd.service.loginbroker.update-period.unit=${dcache.service.loginbroker.update-period.unit}
xrootd.service.loginbroker.update-threshold=${dcache.service.loginbroker.update-threshold}
xrootd.service.loginbroker.version=2.4
xrootd.service.loginbroker.family=root
xrootd.service.pool.timeout=${xrootdPoolTimeout}
xrootd.service.pool.timeout.unit=MILLISECONDS

#  ---- Root path of Xrootd door
#
#   Specifies the root directory exposed through the Xrootd door. Used
#   by both the xrootd and SRM services.
#
(deprecated)xrootdRootPath=/
xrootd.root=${xrootdRootPath}

#  ---- Allowed paths
#
#   These parameters are set to the absolute paths of directories
#   accessible through Xrootd. Multiple directories are separated by a
#   colon. Different directories may be specified for reads and
#   writes. An empty list will disallow access to all directories.
#
(deprecated)xrootdAllowedReadPaths=/
(deprecated)xrootdAllowedWritePaths=
xrootd.authz.read-paths=${xrootdAllowedReadPaths}
xrootd.authz.write-paths=${xrootdAllowedWritePaths}

#  ---- Xrootd plugins
#
#   Comma seperated list of plugins to inject into the xrootd
#   request processing chain.
#
#   dCache ships with a few authentication and authorization plugins:
#
#    gplazma:none - no authentication is performed; user identity is
#                   set to the value of xrootdUser (door only).
#
#    gplazma:gsi  - any xrootd request to the door will use a key-exchange
#                   process to identify the end-user (door only).
#
#    authz:alice-token - ALICE token based authorization plugin.
#
#   The property applies to both the xrootd door and the xrootd mover.
#   The defaults are scoped to the xrootd service and pool service,
#   respectively. Hence the property must either be defined per service
#   or with an explicit scope prefix. See pool.properties for information
#   about xrootd plugins for pools.
#
#   For xrootd doors, a gplazma authentication plugin is required; use
#   gplazma:none if no authentication is desired. Authorization plugins
#   have to be placed after the authentication plugin.
#
#   Third party plugins can be used by adding the plugin to the plugin
#   directory of dCache and specifing the plugin name here. Note that
#   third party authentication plugins have to be loaded with
#   gplazma:<plugin> in doors.
#
(deprecated)xrootd/xrootdPlugins=gplazma:none,authz:none
xrootd.plugins=${xrootdPlugins}

#  ---- User identity used for authorizing operations
#
#   As xrootd requests are not authenticated, an identity has to be
#   chosen for authorizing operations. All operations are performed as
#   this identity.
#
#   The authorization controlled by this parameter is different from
#   the authorization performed by the authorization plugin: The
#   authorization plugin validates the requests themselves
#   indepedently of the file which is accessed. E.g. the token based
#   authorization verifies that the request contains a
#   cryptopgrahically signed token from a trusted source.
#
#   Once the request is authorized it is subject to further
#   authorization by other components in dCache, e.g. PnfsManager or
#   PoolManager. Those authorizations happen wrt. the identity defined
#   by xrootd.authz.user.
#
#   The default is 'nobody', meaning that only world-permissible
#   operations are allowed. Other valid values are 'root' (no further
#   authorization) and a string on the form UID:GID[,GID...], i.e. a
#   numerical UID followed by one or more numerical GIDs. The first
#   GID is the primary one.
#
(deprecated)xrootdUser=nobody
xrootd.authz.user=${xrootdUser}


#  ---- Mover queue
#
#   The mover queue on the pool to which this request will be
#   scheduled.
#
(deprecated)xrootdIoQueue=
xrootd.mover.queue=${xrootdIoQueue}

#  ---- Mover queue timeout
#
#   Specifies the timeout in milliseconds after which the xrootd door
#   gives up on waiting for a mover to start. This places a bound on
#   the maximum mover queue time.
#
(deprecated)xrootdMoverTimeout=180000
xrootd.mover.timeout=${xrootdMoverTimeout}
xrootd.mover.timeout.unit=MILLISECONDS


#
#   Document which TCP ports are opened
#
(immutable)xrootd/net.ports.tcp = ${xrootd.net.port}

(forbidden)xrootdIsReadOnly=Use xrootd.authz.write-paths
(forbidden)xrootdAllowedPaths=Use xrootd.auths.read-paths and xrootd.authz.write-paths
